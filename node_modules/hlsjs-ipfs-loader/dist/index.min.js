var HlsjsIpfsLoader=function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.i=function(value){return value},__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=1)}([function(module,exports,__webpack_require__){"use strict";function getFile(ipfs,rootHash,filename,callback){callback||(callback=function(err,res){}),console.log("Fetching hash for '"+rootHash+"/"+filename+"'"),ipfs.object.get(rootHash,function(err,res){if(err)return callback(err);var fileSize,fileName,hash=null;if(res.links.forEach(function(link){if(link.name===filename)return hash=link.cid.toString(),fileSize=link.size,fileName=link.name,!1}),!hash){var msg="File not found: "+rootHash+"/"+filename;return callback(new Error(msg),null)}console.log("Requesting '"+rootHash+"/"+filename+"'");var resBuf=new ArrayBuffer(fileSize),bufView=new Uint8Array(resBuf),offs=0;const stream=ipfs.catReadableStream(hash);console.log("Received stream for file '"+rootHash+"/"+fileName+"'"),stream.on("data",function(chunk){console.log("Received "+chunk.length+" bytes for file '"+rootHash+"/"+fileName+"'"),bufView.set(chunk,offs),offs+=chunk.length}),stream.on("error",function(err){callback(err,null)}),stream.on("end",function(){callback(null,resBuf)})})}function buf2str(buf){return String.fromCharCode.apply(null,new Uint8Array(buf))}class HlsjsIPFSLoader{constructor(config){this.ipfs=config.ipfs,this.hash=config.ipfsHash}destroy(){}abort(){}load(context,config,callbacks){this.context=context,this.config=config,this.callbacks=callbacks,this.stats={trequest:performance.now(),retry:0},this.retryDelay=config.retryDelay,this.loadInternal()}loadInternal(){var stats=this.stats,context=this.context,callbacks=(this.config,this.callbacks);stats.tfirst=Math.max(performance.now(),stats.trequest),stats.loaded=0;var urlParts=context.url.split("/"),filename=urlParts[urlParts.length-1];getFile(this.ipfs,this.hash,filename,function(err,res){if(err)return void console.log(err);var data,len;"arraybuffer"===context.responseType?(data=res,len=res.length):(data=buf2str(res),len=data.length),stats.loaded=stats.total=len,stats.tload=Math.max(stats.tfirst,performance.now());var response={url:context.url,data:data};callbacks.onSuccess(response,stats,context)})}}module.exports=HlsjsIPFSLoader},function(module,exports,__webpack_require__){module.exports=__webpack_require__(0)}]);